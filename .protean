protean_build() {
  LATEST_GO_VERSION=$(curl 'https://go.dev/VERSION?m=text')
  wget "https://go.dev/dl/$LATEST_GO_VERSION.linux-amd64.tar.gz"
  rm -rf /usr/local/go
  tar -C /usr/local -xzf $LATEST_GO_VERSION.linux-amd64.tar.gz
  rm $LATEST_GO_VERSION.linux-amd64.tar.gz
  /usr/local/go build -ldflags "-linkmode external -extldflags -static" -a whistle-pig.go
}

protean_test() {
  docker-compose up -d
  curl localhost:8088/api/v0/health | grep "{'server': 'API HEALTHY v0'}" || exit 1
  curl -X POST --data "test payload hash" localhost:8088/api/v0/hashbody | grep 0ec6cf1ab39a1adb6a27307c5f602ac0f66926b5ed181944541c8f9c806a8c1c || exit 1
}
